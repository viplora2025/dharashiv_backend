COMPLAINT MODULE â€“ FRONTEND REQUEST GUIDE
1ï¸âƒ£ Create Complaint

POST /complaints
ğŸ” Auth required
ğŸ“ Multipart (media optional)

Headers
Authorization: Bearer <token>
Content-Type: multipart/form-data

Request Body (form-data)
Key	Type	Required
complainer	string (ObjectId)	âœ…
department	string (ObjectId)	âœ…
subject	string	âœ…
description	string	âœ…
specification	string	âŒ
media	file[] (max 5)	âŒ
Variant A â€“ Without Media
{
  "complainer": "65fa1a9d...",
  "department": "65fa2b8c...",
  "subject": "Road damaged",
  "description": "Road near school is broken",
  "specification": "Near main gate"
}

Variant B â€“ With Media
form-data:
complainer = 65fa1a9d...
department = 65fa2b8c...
subject = Water leakage
description = Pipe broken
media = image1.jpg
media = video1.mp4

2ï¸âƒ£ Get All Complaints (Admin)

GET /
ğŸ” Admin only

Query Params (ALL optional)
Param	Example
page	1
limit	10
status	open / in-progress / resolved / closed
department	<departmentId>
filedBy	<userId>
talukaId	<talukaId>
Variant Examples
GET /?page=1&limit=10
GET /?status=open
GET /?talukaId=65fa88...
GET /?department=65aa11&status=resolved

3ï¸âƒ£ Get Complaint By ID

GET /:id
ğŸ” Auth required

Path Param
:id = complaint MongoDB _id

No Body
4ï¸âƒ£ Get Complaints By Complainer

GET /by-complainer/:complainerId
ğŸ” Auth required

Path Param
complainerId = ObjectId

Query Params
page (optional)
limit (optional)

Example
GET /by-complainer/65fa11?page=1&limit=10

5ï¸âƒ£ Update Complaint Status (Admin)

PUT /:id/status
ğŸ” Admin only
ğŸ“¦ JSON

Request Body
{
  "status": "in-progress"
}

Allowed Status Values
open
in-progress
resolved
closed


âŒ Any other value â†’ error

6ï¸âƒ£ Public Track Complaint

GET /track/:complaintId
ğŸ”“ No auth

Path Param
complaintId = CMP-0123-0456-001

No Body
7ï¸âƒ£ My Complaints (Logged-in User)

GET /my
ğŸ” Auth required

Query Params (optional)
Param	Example
page	1
limit	10
status	open / resolved
Example
GET /my?page=1&limit=5
GET /my?status=resolved

8ï¸âƒ£ Add Chat Message

POST /:id/chat
ğŸ” Auth required
ğŸ“ Multipart

Headers
Authorization: Bearer <token>
Content-Type: multipart/form-data

Request Body (Variants)
Variant A â€“ Only Message
{
  "message": "Please resolve soon"
}

Variant B â€“ Only Media
form-data:
media = image.jpg

Variant C â€“ Message + Media
form-data:
message = Here is proof
media = image.jpg
media = audio.mp3


âš ï¸ At least message OR media required

9ï¸âƒ£ Get Complaint Chat

GET /:id/chat
ğŸ” Auth required

Path Param
:id = complaint MongoDB _id

No Body
ğŸ§  IMPORTANT FRONTEND NOTES
âœ… Media Types Supported

image (jpg, png)

video (mp4)

audio (mp3)

pdf

âœ… Chat History Structure (Response)
{
  "message": "Status updated",
  "media": [
    { "type": "image", "url": "https://..." }
  ],
  "byRole": "admin",
  "by": {
    "_id": "65fa...",
    "name": "Admin Name"
  },
  "timestamp": "2026-01-25T10:00:00Z"
}
